import requests
from bs4 import BeautifulSoup

# Set your Confluence URL and login details
url = "https://your-confluence-instance.com/confluence-page"
login_url = "https://your-confluence-instance.com/dologin.action"

# Your Confluence credentials
username = "your-username"
password = "your-password"

# Start a session
session = requests.Session()

# Login payload
login_payload = {
    'os_username': username,
    'os_password': password,
    'os_destination': '',
    'login': 'Log In'
}

# Perform login
login_response = session.post(login_url, data=login_payload)

if login_response.status_code == 200:
    print("Login successful")
else:
    print("Login failed")

# Request the page after login
response = session.get(url)

if response.status_code == 200:
    # Parse the page content with BeautifulSoup
    soup = BeautifulSoup(response.content, 'html.parser')
    
    # Example: extract page title
    title = soup.find('title').get_text()
    print(f"Page Title: {title}")
    
    # Example: extract all headings
    headings = soup.find_all(['h1', 'h2', 'h3'])
    for heading in headings:
        print(f"{heading.name}: {heading.get_text()}")
    
    # You can extract any specific content you need based on the HTML structure of the Confluence page
    # Example: extracting paragraphs
    paragraphs = soup.find_all('p')
    for paragraph in paragraphs:
        print(paragraph.get_text())
else:
    print("Failed to retrieve the page")

# Close the session after you're done
session.close()
